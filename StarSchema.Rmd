---
title: "StarSchema"
author: "Andrew Lowe"
date: "8 January 2018"
output:
  html_document:
    df_print: paged
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Read in the data (and drop the numeric data to save RAM):
```{r, cache=T}
require(data.table)

StarSchema <- fread("C:/Work/Projects/Bayer/ws/Tableau/_work/output/StarSchema_CAT_PT_OVR_1000.csv", 
                    select = c(2, 46, 54, 58, 59, 197), # Just these columns; we don't need the rest
                    showProgress = T)
```

```{r, cache=T}
StarSchema$IS_CATEGORY_MAPPED <- factor(StarSchema$IS_CATEGORY_MAPPED)
StarSchema$MARKET_LEVEL <- factor(StarSchema$MARKET_LEVEL)
StarSchema$SOURCE_CODE <- factor(StarSchema$SOURCE_CODE)
StarSchema$Month <- factor(StarSchema$Month == "")
StarSchema$Distribution_ChainDescription <- factor(StarSchema$Distribution_ChainDescription)
StarSchema$Distribution_Channel_Name <- factor(StarSchema$Distribution_Channel_Name)
```

```{r, cache=T}
table(StarSchema$IS_CATEGORY_MAPPED)/sum(table(StarSchema$IS_CATEGORY_MAPPED))*100
table(StarSchema$MARKET_LEVEL)/sum(table(StarSchema$MARKET_LEVEL))*100
table(StarSchema$SOURCE_CODE)/sum(table(StarSchema$SOURCE_CODE))*100
table(StarSchema$Month)/sum(table(StarSchema$Month))*100
table(StarSchema$Distribution_ChainDescription)/sum(table(StarSchema$Distribution_ChainDescription))*100
table(StarSchema$Distribution_Channel_Name)/sum(table(StarSchema$Distribution_Channel_Name))*100
```

```{r, cache=T}
pie(table(StarSchema$IS_CATEGORY_MAPPED))
pie(table(StarSchema$MARKET_LEVEL))
pie(table(StarSchema$SOURCE_CODE))
pie(table(StarSchema$Month))
pie(table(StarSchema$Distribution_ChainDescription))
pie(table(StarSchema$Distribution_Channel_Name))
```

